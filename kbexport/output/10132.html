<h1>How to run a trace in SQL 2000</h1><h2>10132</h2><h3>Introduction</h3><p>This article provides information on how to run a trace for both VS 2.0 and VS 4.0 clients</p><h3>Symptom</h3><p><BR></p><h3>Cause</h3><p><BR></p><h3>Workaround</h3><p><BR></p><h3>Resolution</h3><p><P class=MsoNormal style="MARGIN: 0in 0in 0pt">Open up SQL Profiler</P><P class=MsoNormal style="MARGIN: 0in 0in 0pt">Select New Trace</P><P class=MsoNormal style="MARGIN: 0in 0in 0pt"><?xml:namespace prefix = o /><o:p> </o:p></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt"><B><U>General Tab</U></B></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt"><B><U><o:p></o:p></U></B> </P><P class=MsoNormal style="MARGIN: 0in 0in 0pt"><B><U><o:p><SPAN style="TEXT-DECORATION: none"></SPAN></o:p></U></B></P><UL style="MARGIN-TOP: 0in" type=disc><LI class=MsoNormal style="MARGIN: 0in 0in 0pt">Enter in Trace Name <LI class=MsoNormal style="MARGIN: 0in 0in 0pt">Save to File <LI class=MsoNormal style="MARGIN: 0in 0in 0pt">Set Maximum size to 50 MB <LI class=MsoNormal style="MARGIN: 0in 0in 0pt">If running a performance trace set duration to end of business day</LI></UL><P class=MsoNormal style="MARGIN: 0in 0in 0pt"><o:p> </o:p><o:p> <SPAN style="FONT-SIZE: 12pt; FONT-FAMILY: 'Times New Roman'"><?xml:namespace prefix = v /><v:shapetype id=_x0000_t75 coordsize="21600,21600" o:spt="75" o:preferrelative="t" filled="f" stroked="f" path="m@4@5l@4@11@9@11@9@5xe"> <IMG alt="" hspace=0 src="C:%5CDocuments%20and%20Settings%5CJ.blalock%5CMy%20Documents%5CMy%20Pictures%5CGeneral%20tab.JPG" align=bottom border=0><v:stroke joinstyle="miter"></v:stroke><v:formulas><v:f eqn="if lineDrawn pixelLineWidth 0"></v:f><v:f eqn="sum @0 1 0"></v:f><v:f eqn="sum 0 0 @1"></v:f><v:f eqn="prod @2 1 2"></v:f><v:f eqn="prod @3 21600 pixelWidth"></v:f><v:f eqn="prod @3 21600 pixelHeight"></v:f><v:f eqn="sum @0 0 1"></v:f><v:f eqn="prod @6 1 2"></v:f><v:f eqn="prod @7 21600 pixelWidth"></v:f><v:f eqn="sum @8 21600 0"></v:f><v:f eqn="prod @7 21600 pixelHeight"></v:f><v:f eqn="sum @10 21600 0"></v:f></v:formulas><v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"></v:path><o:lock v:ext="edit" aspectratio="t"></o:lock></v:shapetype></SPAN></o:p></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt"><B><U>Events Tab</U></B></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt"><B><U><o:p></o:p></U></B> </P><P class=MsoNormal style="MARGIN: 0in 0in 0pt"><B><U><o:p><SPAN style="TEXT-DECORATION: none"></SPAN></o:p></U></B></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt"><U>Standard trace<o:p></o:p></U></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt"><U><o:p><SPAN style="TEXT-DECORATION: none"></SPAN></o:p></U></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt">Remove all Selected Event Classes except for the following</P><P class=MsoNormal style="MARGIN: 0in 0in 0pt">Stored Procedures - RPC:Completed </P><P class=MsoNormal style="MARGIN: 0in 0in 0pt">TSQL- SQL:BatchCompleted</P><P class=MsoNormal style="MARGIN: 0in 0in 0pt"><o:p></o:p> </P><o:p></o:p><P class=MsoNormal style="MARGIN: 0in 0in 0pt"><U>Freezing trace</U></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt"><U><o:p><SPAN style="TEXT-DECORATION: none"></SPAN></o:p></U></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt">Used for capturing a client freeze issue.  Same as a Standard Trace plus the following events</P><P class=MsoNormal style="MARGIN: 0in 0in 0pt">Stored Procedures - RPC:Started </P><P class=MsoNormal style="MARGIN: 0in 0in 0pt">TSQL- SQL:BatchStarted</P><P class=MsoNormal style="MARGIN: 0in 0in 0pt"> </P><P class=MsoNormal style="MARGIN: 0in 0in 0pt"><U>Extended Trace <o:p></o:p></U></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt">We usually only run this trace when Mark requests more details.</P><P class=MsoNormal style="MARGIN: 0in 0in 0pt">Add all Stored Procedures, TSQL and Transactions</P><P class=MsoNormal style="MARGIN: 0in 0in 0pt"><o:p> </o:p></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt"><o:p><IMG alt="" hspace=0 src="C:%5CDocuments%20and%20Settings%5CJ.blalock%5CMy%20Documents%5CMy%20Pictures%5CEvents%20tab.JPG" align=bottom border=0></o:p></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt"><B><U>Data Columns<o:p></o:p></U></B></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt"><o:p> </o:p></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt">If the trace is for any performance related issue, then add “End Time” to end of “Selected data”.  Otherwise just leave the default data columns. <BR>Here are what the default data columns should be:<BR></P><UL></UL><UL><LI><o:p> Event Class</o:p> <LI><o:p>Text Data</o:p> <LI><o:p>Application Name</o:p> <LI><o:p>NTUserName</o:p> <LI><o:p>LoginName</o:p> <LI><o:p>CPU</o:p> <LI><o:p>Reads</o:p> <LI><o:p>Writes</o:p> <LI><o:p>Duration</o:p> <LI><o:p>ClientProcessID</o:p> <LI><o:p>SPID</o:p> <LI><o:p>StartTime</o:p> </LI></UL><P class=MsoNormal style="MARGIN: 0in 0in 0pt"><o:p><IMG alt="" hspace=0 src="C:%5CDocuments%20and%20Settings%5CJ.blalock%5CMy%20Documents%5CMy%20Pictures%5CData%20tab.JPG" align=bottom border=0></o:p></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt"><o:p></o:p> </P><P class=MsoNormal style="MARGIN: 0in 0in 0pt"><STRONG><U>Filters Tab</U></STRONG></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt"><o:p> </o:p></P><UL><LI><DIV class=MsoNormal style="MARGIN: 0in 0in 0pt">For general performance issues, set a filter on the Duration: Equal to or Greater than = 1000</DIV></LI><LI><DIV class=MsoNormal style="MARGIN: 0in 0in 0pt">For reproducable issues, set a filter on the SPID: Equal To <Epro Client SPID> (This can be found on Server Status in VS 4.0 and Utilities Tab in VS 2.0)</DIV></LI></UL><P class=MsoNormal style="MARGIN: 0in 0in 0pt"><o:p> <IMG alt="" hspace=0 src="C:%5CDocuments%20and%20Settings%5CJ.blalock%5CMy%20Documents%5CMy%20Pictures%5CFilter%20tab.JPG" align=bottom border=0></o:p></P></p><h3>Notes</h3><p><BR></p>