<h1>sp_maintenance_frequent fails</h1><h2>10216</h2><h3>Introduction</h3><p></p><h3>Symptom</h3><p><P>sp_maintenance_frequent fails with the following error message:</P><P>Server: Msg 515, Level 16, State 2, Procedure sp_auto_close_assessments, Line 40<BR>Cannot insert the value NULL into column 'progress_date_time', table 'cpr.dbo.p_Assessment_Progress'; column does not allow nulls. INSERT fails.<BR></P></p><h3>Cause</h3><p>Most of the causes of this problem were fixed in build 41.&nbsp;&nbsp;Even with build 44 however this problem can be&nbsp;caused by invalid values in the c_Assessment_Definition table.</p><h3>Workaround</h3><p></p><h3>Resolution</h3><p><P>If the customer is not on build 44 or later, they should be upgraded.&nbsp; Otherwise, the invalid values in the c_Assessment_Definition table can be fixed with the following query:</P><P>UPDATE c_Assessment_Definition<BR>SET auto_close_interval_amount = NULL,<BR>&nbsp;auto_close_interval_unit = NULL<BR>WHERE auto_close_interval_unit IS NOT NULL<BR>AND auto_close_interval_unit NOT IN ('DAY', 'MONTH', 'YEAR')<BR></P></p><h3>Notes</h3><p></p>