<h1>Migration Procedures Live from Version 2 to Version 4</h1><h2>10287</h2><h3>Introduction</h3><p>This article will take you through the process of migrating a customer from version 2 to version 4.</p><h3>Symptom</h3><p><BR></p><h3>Cause</h3><p><BR></p><h3>Workaround</h3><p><BR></p><h3>Resolution</h3><p><FONT style="FONT-FAMILY: arial" size=2>If you are uploading databases please password protect it<BR></FONT><P style="COLOR: rgb(0,0,128); FONT-FAMILY: arial"><FONT size=2><SPAN style="FONT-SIZE: 10pt"></SPAN><?xml:namespace prefix = o /><o:p></o:p></FONT></P><BR><OL style="COLOR: rgb(0,0,128); FONT-FAMILY: arial" type=1><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2><SPAN style="FONT-SIZE: 10pt"></SPAN><SPAN style="FONT-SIZE: 10pt">Ensure that Eproserver 2.5 and EncounterPRO 33.7 are installed</SPAN><o:p></o:p></FONT> <LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2><SPAN style="FONT-SIZE: 10pt">Backup the version 2 database <BR></SPAN></FONT><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2><SPAN style="FONT-SIZE: 10pt"></SPAN><o:p></o:p>Run the below script. You will need to replace <SPAN style="FONT-STYLE: italic"><SPAN style="COLOR: rgb(0,0,255)">CUSTOMER#</SPAN> with customer ID<BR></SPAN></FONT><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>UPDATE c_database_status<BR>SET customer_id <SPAN style="FONT-WEIGHT: bold">= '</SPAN></FONT><FONT size=2><SPAN style="FONT-STYLE: italic"><SPAN style="COLOR: rgb(0,0,255)">CUSTOMER#</SPAN>'</SPAN></FONT> <LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Update Database<SPAN style="FONT-SIZE: 10pt"> </SPAN><o:p></o:p></FONT><OL type=1><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Open EproServer<SPAN style="FONT-SIZE: 10pt"> </SPAN><o:p></o:p></FONT><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Click on "Updates tab"<SPAN style="FONT-SIZE: 10pt"> </SPAN><o:p></o:p></FONT><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Upgrade "Database" to current mod level<SPAN style="FONT-SIZE: 10pt"> </SPAN><o:p></o:p></FONT><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Restart DB Maintenance Mode if "Reports" does not appear<SPAN style="FONT-SIZE: 10pt"> </SPAN><o:p></o:p></FONT><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Upgrade "Reports"<SPAN style="FONT-SIZE: 10pt"> </SPAN><o:p></o:p></FONT><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Upgrade "Config" to current level<SPAN style="FONT-SIZE: 10pt"> </SPAN><o:p></o:p></FONT><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Run all "Hot Fixes"<SPAN style="FONT-SIZE: 10pt"> </SPAN><o:p></o:p></FONT><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2><SPAN style="FONT-SIZE: 10pt">Backup Version 4 database and call it "cpr_40_PreMigration" (optional)</SPAN><o:p></o:p></FONT></LI></OL><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Migrate Patient Data<SPAN style="FONT-SIZE: 10pt"> </SPAN><o:p></o:p></FONT><OL type=1><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Open the DB Maintenance Mode<SPAN style="FONT-SIZE: 10pt"> </SPAN><o:p></o:p></FONT><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Click on "Migrate" tab<SPAN style="FONT-SIZE: 10pt"> </SPAN><o:p></o:p></FONT><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Click on "Patient" button<SPAN style="FONT-SIZE: 10pt"> </SPAN><o:p></o:p></FONT><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Click on "Refresh Scripts" button </FONT><FONT size=2>(Ensure that it says 4.05.12)</FONT> <LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Enter in version 2 Database name in "Database field" (Usually called "cpr")<SPAN style="FONT-SIZE: 10pt"> </SPAN><o:p></o:p></FONT><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Click on "Execute" button<SPAN style="FONT-SIZE: 10pt"> </SPAN><o:p></o:p></FONT><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2><SPAN style="FONT-SIZE: 10pt">Select "yes" to the pop up screens <BR></SPAN></FONT></LI></OL><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Run Utility Scripts<SPAN style="FONT-SIZE: 10pt"> </SPAN><o:p></o:p></FONT><OL type=1><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Open the DB Maintenance Mode<SPAN style="FONT-SIZE: 10pt"> </SPAN><o:p></o:p></FONT><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Click on the "Utilities Scripts" tab<SPAN style="FONT-SIZE: 10pt"> </SPAN><o:p></o:p></FONT><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Select "DB Scripts" and click "Execute"&nbsp; (for 126 run&nbsp;this script in Query&nbsp;<A href="https://www.jmjtech.com/kb/images/10331/DBScripts126.txt"> click here</A>)</FONT> <LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Insure that "Executing Script Succeeded" displays<SPAN style="FONT-SIZE: 10pt"> </SPAN><o:p></o:p></FONT><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Re-run all hot fixes<SPAN style="FONT-SIZE: 10pt"> </SPAN><o:p></o:p></FONT></LI></OL><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Shrink the log file<SPAN style="FONT-SIZE: 10pt"> </SPAN><o:p></o:p></FONT><OL type=1><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Run this command in the Query Analyzer&nbsp;window: Dump transaction cpr_40 with no_log<SPAN style="FONT-SIZE: 10pt"> </SPAN><o:p></o:p></FONT><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Shrink the DB by running "Shrink Transaction log.sql" <A href="https://www.jmjtech.com/kb/images/10331/ShrinkTransactionLog.txt"><SPAN class=SpellE>Shrink</SPAN> Transaction Log</A></FONT> <LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>In Enterprise Manager, right-click on the version 4 database and select "Shrink Database"<SPAN style="FONT-SIZE: 10pt"> </SPAN><o:p></o:p></FONT><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Shrink DB in SQL to 5 %</FONT> <LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Select "Move pages to beginning of file before shrinking"<SPAN style="FONT-SIZE: 10pt"> </SPAN><o:p></o:p></FONT><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2><SPAN style="FONT-SIZE: 10pt">Click Ok</SPAN></FONT></LI></OL><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>SQL Jobs</FONT> <OL><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Delete old SQL Jobs and create SQL Jobs “<A href="https://www.jmjtech.com/kb/images/10287/cpr_40_Maintenance_Scripts.txt">4.0 Maintenance Jobs</A>” (If they are a MPT practice consult with them first)</FONT> <LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Run all Jobs one at a time<BR></FONT></LI></OL><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Backup the version 4 database and call it cpr_40_post_Migration</FONT> <LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2><SPAN style="FONT-SIZE: 10pt"></SPAN><o:p></o:p>Set up automatic printing&nbsp; https://192.168.155.2/kb/Article.aspx?ArticleNumber=10199<BR></FONT><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Ensure that the new client setup files are copied into the install folder of CPRFILES<SPAN style="FONT-SIZE: 10pt"> </SPAN><o:p></o:p></FONT><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Set PMS Interface<SPAN style="FONT-SIZE: 10pt"> </SPAN><o:p></o:p></FONT><OL type=1><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Select the Practice Management tab in EPRO Configuration and select correct PMS<SPAN style="FONT-SIZE: 10pt"> </SPAN><o:p></o:p></FONT><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2><SPAN style="FONT-SIZE: 10pt">Ensure that PMS System exists in the c_offfice table and records exist in o_message_subscription (make sure paths are the same as version 2)</SPAN><o:p></o:p></FONT></LI></OL><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Compare appointment types in version 2 b_appt_type table to that of the version 4 b_appt_type table to assure accuracy<SPAN style="FONT-SIZE: 10pt"> </SPAN><o:p></o:p></FONT><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><FONT size=2>Please run the following queries to CANCEL any pending billing requests<SPAN style="FONT-SIZE: 10pt"> </SPAN></FONT></LI></OL><P class=MsoNormal style="MARGIN: 0in 0in 0pt 0.5in; COLOR: rgb(0,0,128); TEXT-INDENT: 0.5in; FONT-FAMILY: arial"><FONT size=2><SPAN style="FONT-SIZE: 10pt"><EM>Update p_patient_encounter<o:p></o:p></EM></SPAN></FONT></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt 0.5in; COLOR: rgb(0,0,128); TEXT-INDENT: 0.5in; FONT-FAMILY: arial"><FONT size=2><SPAN style="FONT-SIZE: 10pt"><EM>Set stone_flag='Y'<o:p></o:p></EM></SPAN></FONT></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt 0.5in; COLOR: rgb(0,0,128); TEXT-INDENT: 0.5in; FONT-FAMILY: arial"><FONT size=2><SPAN style="FONT-SIZE: 10pt"><EM>Where stone_flag = 'N'<o:p></o:p></EM></SPAN></FONT></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt 0.5in; COLOR: rgb(0,0,128); TEXT-INDENT: 0.5in; FONT-FAMILY: arial"><FONT size=2><SPAN style="FONT-SIZE: 10pt"><EM>And encounter_status = 'CLOSED'<o:p></o:p></EM></SPAN></FONT></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt 0.5in; COLOR: rgb(0,0,128); TEXT-INDENT: 0.5in; FONT-FAMILY: arial"><FONT size=2><SPAN style="FONT-SIZE: 10pt"><o:p><EM>&nbsp;</EM></o:p></SPAN></FONT></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt 0.5in; COLOR: rgb(0,0,128); TEXT-INDENT: 0.5in; FONT-FAMILY: arial"><FONT size=2><SPAN style="FONT-SIZE: 10pt"><EM>Update p_patient_wp_item<o:p></o:p></EM></SPAN></FONT></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt 0.5in; COLOR: rgb(0,0,128); TEXT-INDENT: 0.5in; FONT-FAMILY: arial"><FONT size=2><SPAN style="FONT-SIZE: 10pt"><EM>SET status = ‘CANCELLED’<o:p></o:p></EM></SPAN></FONT></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt 0.5in; COLOR: rgb(0,0,128); TEXT-INDENT: 0.5in; FONT-FAMILY: arial"><FONT size=2><SPAN><EM>WHERE ordered_service = ‘SENBILLING’<o:p></o:p></EM></SPAN></FONT></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt 0.5in; COLOR: rgb(0,0,128); TEXT-INDENT: 0.5in; FONT-FAMILY: arial"><FONT size=2><SPAN style="FONT-SIZE: 10pt"><EM>AND status in <SPAN>('DISPATCHED','STARTED')</SPAN></EM><o:p></o:p></SPAN></FONT></P><P style="COLOR: rgb(0,0,128); FONT-FAMILY: arial"><FONT size=2></FONT>&nbsp;</P></p><h3>Notes</h3><p><P class=MsoNormal style="MARGIN: 0in 0in 0pt 0.25in; TEXT-ALIGN: center" align=center><SPAN style="FONT-SIZE: 12pt"><STRONG>Migration Testing Checklist<?xml:namespace prefix = o /><o:p></o:p></STRONG></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt 0.25in"><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 12pt"><o:p>&nbsp;</o:p></SPAN></P><OL style="MARGIN-TOP: 0in" type=1><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 12pt">Create new test patient<o:p></o:p></SPAN> <LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 12pt">Create encounters from simple to complex types<o:p></o:p></SPAN> <LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 12pt">View &amp; print frequently used reports<o:p></o:p></SPAN> <LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 12pt">View Scanned Image</SPAN><LI class=MsoNormal style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 12pt">Inform client that all patient in NOWHERE with no services are patients with encounters that have open encounters. If practice requests us to close them or some of them run the following query in query analyzer against version 4.0 database:<o:p></o:p></SPAN></LI></OL><P class=MsoNormal style="MARGIN: 0in 0in 0pt; TEXT-INDENT: 0.5in"><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 12pt">UPDATE p_Patient_Encounter<o:p></o:p></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; TEXT-INDENT: 0.5in"><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 12pt">SET encounter_status = ‘CLOSED’<o:p></o:p></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; TEXT-INDENT: 0.5in"><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 12pt">WHERE encounter_status = ‘OPEN’<o:p></o:p></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; TEXT-INDENT: 0.5in"><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 12pt">AND encounter_date_time &lt; getdate()<o:p></o:p></SPAN></P></p>