<h1>Exiting attachment review screen shuts down EncounterPRO</h1><h2>10303</h2><h3>Introduction</h3><p></p><h3>Symptom</h3><p>When the user sees the attachment review or attachment transcription screen, the attachment is supposed to come up in a separate window.&nbsp; If the attachment does not come up in a separate window, then sometimes when the user exits the review/transcription screen then windows starts to shut down.</p><h3>Cause</h3><p><P>The attachment review and attachment transcription screens automatically attempt to bring up the attachment in a separate window by calling the windows shell "open" command.&nbsp; EncounterPRO will record the process id returned by windows and when the attachment review&nbsp;or attachment transcription screen is exited then EncounterPRO will attempt to stop the process that was started by the shell "open" command.</P><P>If the windows shell is not configured with an "open" command for that file type, or if the appropriate application is not installed correctly, then the opening of the attachment might fail.&nbsp; In this case windows returns a zero to EncounterPRO.&nbsp; Upon exiting the screen, EncounterPRO will attempt to stop the process with a process-id of zero, which Windows interprets as a request to shut down the computer.</P></p><h3>Workaround</h3><p><P>Two workarounds can be tried.&nbsp; The first is to configure EncounterPRO in the c_Attachment_Extension table to use a specific application or the internal JMJ Image Viewer to open the attachment.&nbsp; See KB Article # 10266 for instructions.</P><P>The second option is to install an appropriate application in the computer so that when EncounterPRO issues the shell "open" command for the file type in question , then windows correctly opens the attachment.</P></p><h3>Resolution</h3><p>This was reported as dev issue # 5423 and fixed in the EncounterPRO client version 4.05.34.</p><h3>Notes</h3><p></p>