<h1>Service will not start -- Process performance counter is disabled</h1><h2>10379</h2><h3>Introduction</h3><p></p><h3>Symptom</h3><p><p>EncounterPRO Agent Service will not start</p><p>The following error appears in the event log:<br><code>Service cannot be started. System.InvalidOperationException: Process performance counter is disabled, so the requested operation cannot be performed.</code></p><p>Duplicate billing.<br><code></code></p></p><h3>Cause</h3><p><p>The EncounterPRO Agent Service attempts to locate other EncounterPRO Agent processes running at startup and kills any that it finds.&nbsp; The process performance counter is used by .NET to locate running processes.&nbsp; On some computers, this counter and others may be disabled, leading to this failure mode.</p><p>It is possible that the counter may also be corrupted.  There are steps to fix that as well.</p></p><h3>Workaround</h3><p></p><h3>Resolution</h3><p><p>There is a Windows 2000 resource kit tool that can be used to enable and disable specific performance counters:<br><a href="http://www.activexperts.com/activmonitor/windowsmanagement/reskit2000/">http://www.activexperts.com/activmonitor/windowsmanagement/reskit2000/</a></p><p>This tool can be used with Windows XP, Windows 2000, and Windows 2003.</p><p>After the tool is installed, go to the install location (default C:\Program Files\Resource Kit)&nbsp;to run exctrlst.exe.</p><p>A list of performance counters will be presented.&nbsp; The one that needs to be enabled is called PerfProc.&nbsp; Find this entry in the list and select it.&nbsp; Then check the box labeled "Performance Counters Enabled".</p><p>Next, make sure that the Process performance counter is functional.  Click Start\Run... and type perfmon.  Click OK.  Add counters from the Process category and make sure they appear to be working properly.</p><p>If the counters appear to be corrupted, you can follow the steps in this MSKB article to fix them: <a href="http://support.microsoft.com/?kbid=300956">How to manually rebuild Performance Counter Library values</a></p><p>Close exctrlst.exe and start the EncounterPRO Agent Service.</p></p><h3>Notes</h3><p></p>