<h1>Editing attachment doesn't work</h1><h2>10432</h2><h3>Introduction</h3><p></p><h3>Symptom</h3><p><P>When a user attempts to edit an attachment from inside a patient's chart, nothing happens and they get an error message in the event viewer like this:</P><P>4.05.34.7 (5/19/2005) &gt;&gt;&gt; u_component_attachment_generic - (edit_attachment()) Error opening attachment (c:\temp\jmj_318_199__050715134813_4.bmp)<BR></P></p><h3>Cause</h3><p>This error is caused by EncounterPRO attempting to edit an attachment with a program that is either not installed correctly or not appropriate for the attachment type.&nbsp; EncounterPRO uses the data in the c_Attachment_Extension table to determine how to display, edit, or print attachments.&nbsp;</p><h3>Workaround</h3><p><P>There are two utility scripts which will set the c_Attachment_Extension configuration for all Image attachment types.&nbsp; They are:</P><P>Set Image Attachment Control to GENERIC<BR>Set Image Attachment Control to COM</P><P>The GENERIC attachment handler calls the Windows Shell to display, edit or print an attachment.&nbsp; This should work provided that an appropriate application has been installed to handle the operation.</P><P>The COM attachment handler uses a program provided by JMJ to display, edit and print attachments.&nbsp; This option is available in Build 34.x or later.</P><P>For customers using EncounterPRO Client Build 33.x or earlier, run the "Set Image Attachment Control to GENERIC" utility script from the DB Maintenance Utilities screen.</P><P>For customers using EncounterPRO Client Build 34.x or later, run the "Set Image Attachment Control to COM" utility script from the DB Maintenance Utilities screen.</P><P>NOTE:&nbsp; These utilities are provided to configure an EncounterPRO installation whose attachments are NOT WORKING.&nbsp; If the attachment display and edit are working, there is no need to run either of these utilities.&nbsp; Furthermore, if the installation is working with Build 33.x, then it will continue to work with 34.x without making any changes to c_Attachment_Extension.</P><P>&nbsp;</P></p><h3>Resolution</h3><p><P>Have a trained support person examine the c_Attachment_Extension table to be sure that it is properly configured.</P></p><h3>Notes</h3><p></p>