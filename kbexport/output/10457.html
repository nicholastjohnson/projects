<h1>Discrepancy between c_drug_definition and c_vaccine</h1><h2>10457</h2><h3>Introduction</h3><p>This article explains Hotfix 98 and what to do if dev 5822 is notresolved at a practice. In other words, if the GRITS Batch reportenhancement has been applied (in EprolibNet 4.05.104 or EproServer5.1.4) but there are still some missing patient data, read this.<br></p><h3>Symptom</h3><p><br></p><h3>Cause</h3><p><br></p><h3>Workaround</h3><p><br></p><h3>Resolution</h3><p>Run Hotifx 98.<br>This will fix present and future discrepancies between c_drug_definition and c_vaccine<br></p><h3>Notes</h3><p>Here is the code of the Hotfix:<br><br>--This hotfix fixes the discrepancy between c_drug_definition and c_vaccine .<br>--First it repairs any drug_ids missing, according to c_vaccine,<br>--then it creates the triggers that will keep the tables consistent.<br>--Furthermore, this fixes the problem with the GRITS Batch report enchancement,<br>--problem found in this support issue: #23247<br><br>INSERT INTO c_drug_definition (<br>drug_id, common_name, status)<br>SELECT vaccine_id, description, status<br>FROM c_vaccine<br>where vaccine_id&nbsp; not in (select distinct drug_id from c_drug_definition)<br><br>GO<br><br>if exists (select * from sysobjects where id = object_id('dbo.tr_c_vaccine_all') )<br>&nbsp;&nbsp;&nbsp; drop trigger dbo.tr_c_vaccine_all<br>GO<br><br>CREATE TRIGGER tr_c_vaccine_all ON dbo.c_vaccine<br>FOR INSERT, UPDATE<br>AS<br><br>UPDATE c_Table_Update<br>SET last_updated = getdate()<br>WHERE table_name = 'c_vaccine'<br><br>GO<br><br>if exists (select * from sysobjects where id = object_id('dbo.tr_c_vaccine_update') )<br>&nbsp;&nbsp;&nbsp; drop trigger dbo.tr_c_vaccine_update<br>GO<br><br>CREATE TRIGGER tr_c_vaccine_update ON dbo.c_vaccine<br>FOR UPDATE<br>AS<br><br>UPDATE d<br>SET d.common_name = v.description, d.status=v.status<br>FROM c_drug_definition d, inserted v<br>WHERE d.drug_id = v.vaccine_id<br><br>GO<br><br>if exists (select * from sysobjects where id = object_id('dbo.tr_c_vaccine_insert') )<br>&nbsp;&nbsp;&nbsp; drop trigger dbo.tr_c_vaccine_insert<br>GO<br><br>CREATE TRIGGER tr_c_vaccine_insert ON dbo.c_vaccine<br>FOR INSERT<br>AS<br><br>INSERT INTO c_drug_definition (<br>drug_id, common_name, status)<br>SELECT vaccine_id, description, status<br>FROM inserted <br><br>GO<br></p>