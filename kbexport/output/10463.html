<h1>Problem with ECG and Spirometer after upgrade</h1><h2>10463</h2><h3>Introduction</h3><p></p><h3>Symptom</h3><p>Below are some errors that you might get when you display an ECG\CAR file or when entering in results<br><br><font size="2">Ver. NA &gt;&gt;&gt; AxInterop.SPIROACTIVEXLib - (AttachInterfaces) System.IO.FileLoadException: The located assembly's manifest definition with name 'Interop.SPIROACTIVEXLib' does not match the assembly reference.<br>File name: "Interop.SPIROACTIVEXLib"<br>&nbsp;&nbsp; at AxSPIROACTIVEXLib.AxSpiroActiveX.AttachInterfaces()<br>&nbsp;&nbsp; at System.Windows.Forms.AxHost.GetOcxCreate()<br>&nbsp;&nbsp; at System.Windows.Forms.AxHost.TransitionUpTo(Int32 state)<br>&nbsp;&nbsp; at System.Windows.Forms.AxHost.CreateHandle()<br>&nbsp;&nbsp; at System.Windows.Forms.Control.CreateControl(Boolean fIgnoreVisible)<br>&nbsp;&nbsp; at System.Windows.Forms.Control.CreateControl(Boolean fIgnoreVisible)<br>&nbsp;&nbsp; at System.Windows.Forms.AxHost.EndInit()<br>&nbsp;&nbsp; at EproLibNET.fBrentwoodSpiro.InitializeComponent()<br>&nbsp;&nbsp; at EproLibNET.fBrentwoodSpiro..ctor()<br>&nbsp;&nbsp; at EproLibNET.BrentwoodSpiro.Is_Connected()<br><br></font><font size="2">=== Pre-bind state information ===<br>LOG: DisplayName = Interop.SPIROACTIVEXLib, Version=1.0.0.0, Culture=neutral, PublicKeyToken=e349e2da3a3c5167<br>&nbsp;(Fully-specified)<br>LOG: Appbase = C:\Program Files\JMJ\EncounterPRO\<br>LOG: Initial PrivatePath = NULL<br>Calling assembly : AxInterop.SPIROACTIVEXLib, Version=1.0.0.0, Culture=neutral, PublicKeyToken=e349e2da3a3c5167.<br>===<br><br>LOG: Publisher policy file is not found.<br>LOG: Host configuration file not found.<br>LOG: Using machine configuration file from C:\WINDOWS\Microsoft.NET\Framework\v1.1.4322\config\machine.config.<br>LOG: Post-policy reference: Interop.SPIROACTIVEXLib, Version=1.0.0.0, Culture=neutral, PublicKeyToken=e349e2da3a3c5167<br>LOG: Attempting download of new URL file:///C:/Program Files/JMJ/EncounterPRO/Interop.SPIROACTIVEXLib.DLL.<br>WRN: Comparing the assembly name resulted in the mismatch: PUBLIC KEY TOKEN<br><br></font><font size="2">UNKNOWN CALLER - (SYSTEM ERROR) errornum:35<br>message :Error calling external object function setreportdatadirect at line 14 in open event of object w_attachment_brentwood_display.<br>where&nbsp;&nbsp; :w_attachment_brentwood_display<br>object&nbsp; :w_attachment_brentwood_display<br>event&nbsp;&nbsp; :open<br>line&nbsp;&nbsp;&nbsp; :14</font><br></p><h3>Cause</h3><p></p><h3>Workaround</h3><p></p><h3>Resolution</h3><p><font style="color: rgb(0, 0, 128); font-family: Arial;" size="2">Follow the below steps<br><br>Download and install Brentwood software from this location (You will need RAR to unzip) \EP_Upgrades\Production\Encounter_Production_CD\JMJ_Support\Programs\IQMarkSDK633<br><br>If this does not fix this problem you will need to copy all of the files from the below location and copy them to c:\windows or winnt\assembly<br><br>\EP_Upgrades\Production\Encounter_Production_CD\JMJ_Support\Programs\ECG Fix<br><br>If this does not fix the problem do a search for regasm.exe and drop the four newly copied files to this folder<br><br></font><p style="color: rgb(0, 0, 128); font-family: Arial;" class="MsoNormal"><font size="2"><span style="font-size: 10pt;">Under resolution, the name of the product you’ll need is WinRAR (<a title="http://www.rarsoft.com/" href="http://www.rarsoft.com/">www.rarsoft.com</a>)<o:p></o:p></span></font></p><p style="color: rgb(0, 0, 128); font-family: Arial;" class="MsoNormal"><font size="2"><span style="font-size: 10pt;"><o:p></o:p>The 2<sup>nd</sup> step under resolution is a little unclear about what directory to drop files into.&nbsp; If you want to avoid specifying the C:\windows or C:\winnt part, you can just say %WINDIR%\assembly<o:p></o:p></span></font></p><p style="color: rgb(0, 0, 128);" class="MsoNormal"><font face="Arial" size="2"><span style="font-size: 10pt; font-family: Arial;"><font style="color: rgb(0, 0, 128); font-family: Arial;" size="2">And the 4 files for ECG Fix can’t be registered, so the last line can be dropped.</font><o:p></o:p></span></font></p><br></p><h3>Notes</h3><p></p>