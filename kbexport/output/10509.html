<h1>How to set up workplan archiving</h1><h2>10509</h2><h3>Introduction</h3><p><P>At large sites, the workplan tables can get very large.&nbsp; If the customer is running SQL Server 2000 standard edition, SQL Server will only be allowed to consume about 1.7G of RAM from the operating system.&nbsp; When the workplan tables reach 50+G, then not enough of the indexes for the workplan tables can be kept in SQL Server's cache to prevent frequent disk accesses.&nbsp; Since EncounterPRO consults the workplan tables very often, this can result in a significant performance degradation.</P><P>One solution is to purchase SQL Server Enterprise and provide enough system RAM in the database server that SQL Server can consume whatever it needs.</P><P>Another, albeit temporary, solution is to move a significant number of closed workplans from the active workplan tables to archive workplan tables.&nbsp; This does not decrease the amount of disk space used by the EncounterPRO database, but it reduces the size of the active workplan table indexes so that a higher percentage of them can be cached with SQL Server Standard Edition</P></p><h3>Symptom</h3><p></p><h3>Cause</h3><p></p><h3>Workaround</h3><p></p><h3>Resolution</h3><p><P>To set up Workplan Archiving, follow the following steps:</P><OL style="MARGIN-TOP: 0in" type=1><LI class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-list: l0 level1 lfo1; tab-stops: list .5in">Upgrade the database to Mod Level 126, if necessary</LI><LI class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-list: l0 level1 lfo1; tab-stops: list .5in">Perform a “Check Now” on the DB Maintenance Upgrade Tab</LI><LI class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-list: l0 level1 lfo1; tab-stops: list .5in">On the DB Maintenance Hotfix Tab Run all Hotfixes which have not been run yet</LI><LI class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-list: l0 level1 lfo1; tab-stops: list .5in">On the DB Maintenance Utility Tab, Run the “Workplan Archive Setup” utility</LI><OL style="MARGIN-TOP: 0in" type=a><LI class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-list: l0 level2 lfo1; tab-stops: list 1.0in">On some servers, SQL Server will report the extension of a database as an error, even though it’s really just informational.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>If an error is reported running the “Workplan Archive Setup” utility, run it again.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>If it succeeds the second time, then everything is OK.</LI></OL><LI class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-list: l0 level1 lfo1; tab-stops: list .5in">Set up a SQL Agent job as follows:</LI><OL style="MARGIN-TOP: 0in" type=a><LI class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-list: l0 level2 lfo1; tab-stops: list 1.0in">SQL Script: EXECUTE jmj_Archive_Workplan_Batch</LI><LI class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-list: l0 level2 lfo1; tab-stops: list 1.0in">Schedule: Every night, every three minutes between <?xml:namespace prefix = st1 ns = "urn:schemas-microsoft-com:office:smarttags" /><st1:time Hour="0" Minute="0">midnight</st1:time> and <st1:time Hour="6" Minute="0">6:00AM</st1:time></LI></OL></OL><P class=MsoNormal style="MARGIN: 0in 0in 0pt"><?xml:namespace prefix = o ns = "urn:schemas-microsoft-com:office:office" /><o:p>&nbsp;</o:p></P></p><h3>Notes</h3><p></p>