<h1>How to remove orphan  p  records</h1><h2>10585</h2><h3>Introduction</h3><p><P>&nbsp;</P></p><h3>Symptom</h3><p>When a new chart is&nbsp;created, it appears that the new chart already has data such as encounters or chart alerts.</p><h3>Cause</h3><p><P>EncounterPRO version 2 allowed for the deletion of patient records in certain circumstances, such as the merging of two charts.&nbsp; Sometimes the p_Patient records would be deleted but not all the records in the other "p" tables would get deleted.&nbsp; Since EncounterPRO version 2 did not re-use cpr_id values, this was never a problem and the orphan records were never noticed.</P><P>However, once the data is migrated to version 4, a different cpr_id assignment algorithm is used which can result in a cpr_id being assigned that was once used in version 2 but was subsequently deleted.&nbsp; When such a value is assigned in the p_Patient table, the orphan records in the other "p" tables become attached to that chart.</P></p><h3>Workaround</h3><p><P>Run the utility script&nbsp;in the DB Maintenance utility called "Remove Orphans From P Tables.sql".&nbsp; </P><P>This utility script will remove all of the records in the "p" tables that:<BR>&nbsp;a) do not have a corresponding p_Patient records (orphans)<BR>&nbsp;b) are created prior to the migration where the corresponding p_Patient record was create after the migration</P><P>This utility script will lock up the "p" tables while it runs.&nbsp; it is necessary to run this utility script while no one is using EncounterPRO.</P></p><h3>Resolution</h3><p>A script has been added to Migration Version 4.05.15 to identify and remove the orphan "p" records from the version 4 database.</p><h3>Notes</h3><p></p>