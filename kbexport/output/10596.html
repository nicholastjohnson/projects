<h1>get a list of open diagnosis or close the diagnosis for a given date range</h1><h2>10596</h2><h3>Introduction</h3><p>this article explains how to get a list of open diagnosis for a given date range or a specific diagnosis.</p><h3>Symptom</h3><p></p><h3>Cause</h3><p></p><h3>Workaround</h3><p></p><h3>Resolution</h3><p><P><STRONG><U>Get list of all the open diagnosis for a given date range:</U></STRONG></P><P>SELECT cpr_id,assessment_type,assessment_id,assessment,begin_date<BR>FROM p_assessment<BR>WHERE (assessment_status is null or assessment_status='open')<BR>AND begin_date &gt; [enter begin date] and begin_date &lt;&nbsp;[enter end date]</P><P><STRONG><EM>the example below is filtering out all the open diagnosis between 2001-2004</EM></STRONG></P><P>SELECT cpr_id,assessment_type,assessment_id,assessment,begin_date<BR>FROM p_assessment<BR>WHERE (assessment_status is null or assessment_status='open')<BR>AND begin_date &gt; '1/1/2001' and begin_date &lt; '1/1/2005'</P><P><STRONG><U>Get list of all the open diagnosis for a given assessment and&nbsp;date range:</U></STRONG></P><P>SELECT cpr_id,assessment_type,assessment_id,assessment,begin_date<BR>FROM p_assessment<BR>WHERE (assessment_status is null or assessment_status='open')<BR>AND begin_date &gt; '1/1/2001' and begin_date &lt; '1/1/2005'<BR>AND assessment like '%&lt;enter&nbsp;diagnosis description&gt;%'<BR></P><P><EM><STRONG>the example below is filtering out the open 'acute' diagnosis between 2001 - 2004</STRONG></EM></P><P>SELECT cpr_id,assessment_type,assessment_id,assessment,begin_date<BR>FROM p_assessment<BR>WHERE (assessment_status is null or assessment_status='open')<BR>AND begin_date &gt; '1/1/2001' and begin_date &lt; '1/1/2005'<BR>AND assessment like '%acute%'<BR></P><P><STRONG><U>Close&nbsp;list of all the open diagnosis for a given date range:</U></STRONG></P><P><STRONG><EM>Fill in the begin date (like '1/1/2001')&nbsp;and end date (like '1/1/2005') and then run the following query. <FONT size=5>run this query during their non business hours.</FONT></EM></STRONG></P><P>DECLARE @ll_problem_id integer<BR>DECLARE @ll_encounter_id integer<BR>DECLARE @ls_cpr_id varchar(36)</P><P>DECLARE auto_close_diag CURSOR LOCAL FAST_FORWARD TYPE_WARNING FOR<BR>&nbsp;SELECT cpr_id,problem_id,open_encounter_id<BR>&nbsp;FROM p_Assessment p, c_Assessment_Definition c<BR>&nbsp;WHERE&nbsp; p.assessment_id = c.assessment_id<BR>&nbsp;AND (p.assessment_status IS NULL or lower(p.assessment_status) = 'open')<BR>&nbsp;AND p.begin_date &gt; &lt;enter begin date&gt; and p.begin_date &lt;&nbsp; &lt;enter end date&gt;</P><P><BR>OPEN auto_close_diag<BR>FETCH auto_close_diag INTO @ls_cpr_id,@ll_problem_id,@ll_encounter_id<BR>WHILE @@FETCH_STATUS = 0<BR>&nbsp;BEGIN&nbsp; EXECUTE sp_set_assessment_progress<BR>&nbsp; @ps_cpr_id = @ls_cpr_id,<BR>&nbsp; @pl_problem_id = @ll_problem_id,<BR>&nbsp; @pl_encounter_id = @ll_encounter_id,<BR>&nbsp; @ps_progress_type = 'CLOSED',<BR>&nbsp; @ps_user_id = '#SYSTEM',<BR>&nbsp; @ps_created_by = '#SYSTEM'<BR>&nbsp;FETCH auto_close_diag INTO @ls_cpr_id,@ll_problem_id,@ll_encounter_id<BR>&nbsp;END<BR>CLOSE auto_close_diag<BR>DEALLOCATE auto_close_diag<BR></P><P><STRONG><U>Close&nbsp;list of all the open diagnosis for a given assessment and date range:</U></STRONG></P><P><STRONG><EM>Fill in the begin date (like '1/1/2001')&nbsp;and end date (like '1/1/2005') and a assesment desc (like '%acute%') and then run the following query. <FONT size=4><FONT size=5>run this query during their non business hours</FONT>.</FONT></EM></STRONG></P><P>DECLARE @ll_problem_id integer<BR>DECLARE @ll_encounter_id integer<BR>DECLARE @ls_cpr_id varchar(36)</P><P>DECLARE auto_close_diag CURSOR LOCAL FAST_FORWARD TYPE_WARNING FOR<BR>&nbsp;SELECT cpr_id,problem_id,open_encounter_id<BR>&nbsp;FROM p_Assessment p, c_Assessment_Definition c<BR>&nbsp;WHERE&nbsp; p.assessment_id = c.assessment_id<BR>&nbsp;AND (p.assessment_status IS NULL or lower(p.assessment_status) = 'open')<BR>&nbsp;AND p.begin_date &gt;&nbsp;&lt;enter begin date&gt;&nbsp;and p.begin_date &lt;&nbsp;&lt;enter end date&gt;<BR>&nbsp;AND p.assessment like '%&lt;enter assessment desc&gt;%'</P><P><BR>OPEN auto_close_diag<BR>FETCH auto_close_diag INTO @ls_cpr_id,@ll_problem_id,@ll_encounter_id<BR>WHILE @@FETCH_STATUS = 0<BR>&nbsp;BEGIN&nbsp; EXECUTE sp_set_assessment_progress<BR>&nbsp; @ps_cpr_id = @ls_cpr_id,<BR>&nbsp; @pl_problem_id = @ll_problem_id,<BR>&nbsp; @pl_encounter_id = @ll_encounter_id,<BR>&nbsp; @ps_progress_type = 'CLOSED',<BR>&nbsp; @ps_user_id = '#SYSTEM',<BR>&nbsp; @ps_created_by = '#SYSTEM'<BR>&nbsp;FETCH auto_close_diag INTO @ls_cpr_id,@ll_problem_id,@ll_encounter_id<BR>&nbsp;END<BR>CLOSE auto_close_diag<BR>DEALLOCATE auto_close_diag<BR></P></p><h3>Notes</h3><p><P>&nbsp;</P></p>