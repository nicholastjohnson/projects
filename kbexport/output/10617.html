<h1>How version 2 Server Service determines it's own office_id</h1><h2>10617</h2><h3>Introduction</h3><p>When the server server starts for version 2, it must first determine it's own office_id before it can consult the o_Server_component table to find out what component(s) to run.</p><h3>Symptom</h3><p></p><h3>Cause</h3><p></p><h3>Workaround</h3><p></p><h3>Resolution</h3><p><P>On startup, the version 2 server service uses the following algorithm to determine it's office_id:</P><P class=MsoNormal style="MARGIN: 0in 0in 0pt 0.5in; TEXT-INDENT: -0.25in; mso-list: l0 level1 lfo1; tab-stops: list .5in"><SPAN style="mso-list: Ignore">1)<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN>Consult the registry key:</P><P class=MsoNormal style="MARGIN: 0in -1.25in 0pt 0.5in"><SPAN style="mso-spacerun: yes">&nbsp;</SPAN>HKEY_LOCAL_MACHINE\SOFTWARE\JMJ Technologies\EncounterPro\Database</P><P class=MsoNormal style="MARGIN: 0in -1.25in 0pt 0.5in">If it finds an value called “office_id” then that value will be used</P><P class=MsoNormal style="MARGIN: 0in -1.25in 0pt 0.5in; TEXT-INDENT: -0.25in; mso-list: l0 level1 lfo1; tab-stops: list .5in"><SPAN style="mso-list: Ignore">2)<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN>If the windows logon begins with "epro" and is at least 8 characters long, the last four characters are the office_id </P><P class=MsoNormal style="MARGIN: 0in -1.25in 0pt 0.5in; TEXT-INDENT: -0.25in; mso-list: l0 level1 lfo1; tab-stops: list .5in"><SPAN style="mso-list: Ignore">3)<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN>Use the min office_id found in the c_Office table</P><P>&nbsp;</P></p><h3>Notes</h3><p></p>