<h1>How to copy thin client computer settings from one server to another version 2</h1><h2>10619</h2><h3>Introduction</h3><p><P>When an application server is replaced and the new server has a different computer name than the old server, EncounterPRO will not recognize the computer settings of the thin clients as they log into the new application server.&nbsp; This procedure will copy the </P></p><h3>Symptom</h3><p></p><h3>Cause</h3><p></p><h3>Workaround</h3><p></p><h3>Resolution</h3><p><P>Run the following script after substituting the desired from and to server names:</P><P>&nbsp;</P><P>----------------------------------------------------------------------------------------------</P><P>-- Version 2 Computer based settings copy<BR>--<BR>-- This script will copy all computer based settings from one application server to<BR>-- another application server.&nbsp; It is assumed that the windows logons remain the same.<BR>--</P><P>DECLARE @ls_from_server varchar(40),<BR>&nbsp;@ls_to_server varchar(40)</P><P>-------------------------------------------------------------<BR>-- !!!!!!!!&nbsp; SET THESE VALUES&nbsp; !!!!!!!!!<BR>SET @ls_from_server = 'TSSERVER01'<BR>SET @ls_to_server = 'GPAMLLC-TSS01'<BR>-------------------------------------------------------------</P><P>-- Make sure the append_userid_to_computername is set for the new server<BR>DELETE<BR>FROM o_Preferences<BR>WHERE preference_type = 'SYSTEM'<BR>AND user_id = '!!' + @ls_to_server<BR>AND preference_id = 'append_userid_to_computername'</P><P>INSERT INTO o_Preferences (<BR>&nbsp;preference_type,<BR>&nbsp;user_id,<BR>&nbsp;preference_id,<BR>&nbsp;preference_value)<BR>VALUES (<BR>&nbsp;'SYSTEM',<BR>&nbsp;'!!' + @ls_to_server,<BR>&nbsp;'append_userid_to_computername',<BR>&nbsp;'true')</P><P>-- First copy the preferences<BR>INSERT INTO o_Preferences (<BR>&nbsp;preference_type,<BR>&nbsp;user_id,<BR>&nbsp;preference_id,<BR>&nbsp;preference_value)<BR>SELECT preference_type,<BR>&nbsp;'!!' + @ls_to_server + '\' + SUBSTRING(user_id, LEN(@ls_from_server) + 4, 50),<BR>&nbsp;preference_id,<BR>&nbsp;preference_value<BR>FROM o_Preferences p1<BR>WHERE user_id LIKE '!!'+ @ls_from_server + '\%'<BR>AND NOT EXISTS (<BR>&nbsp;SELECT 1<BR>&nbsp;FROM o_Preferences p2<BR>&nbsp;WHERE p2.preference_type = p1.preference_type<BR>&nbsp;AND p2.user_id = '!!' + @ls_to_server + '\' + SUBSTRING(p1.user_id, LEN(@ls_from_server) + 4, 50)<BR>&nbsp;AND p2.preference_id = p1.preference_id<BR>&nbsp;AND p2.preference_value = p1.preference_value )</P><P><BR>-- Then change the room assignments<BR>UPDATE r<BR>SET room_computer = @ls_to_server + '\' + SUBSTRING(room_computer, LEN(@ls_from_server) + 2, 50)<BR>FROM o_Rooms r<BR>WHERE room_computer LIKE @ls_from_server + '\%'</P><P>GO</P><P>------------------------------------------------------------------------------------------</P></p><h3>Notes</h3><p></p>